labs(x = 'Xylem vessel diameter (µm)',
y = 'Contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
slopes = 1/(data_ind$N*(data_ind$Dh*1000*1000)**4)
test_plot <- expr(
ggplot(data_kh) +
geom_point(aes(x = d*1000*1000, y = Kp_uni2,color = Dh*1000*1000)) +
# scale_x_log10() +
scale_y_log10() +
labs(x = 'Xylem vessel diameter (µm)',
y = 'Contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
slopes = 1/(data_ind$N*(data_ind$Dh*1000*1000)**4)
test_plot <- expr(
ggplot(data_kh) +
geom_lines(aes(x = d*1000*1000, y = Kp_uni2,color = Dh*1000*1000)) +
# scale_x_log10() +
scale_y_log10() +
labs(x = 'Xylem vessel diameter (µm)',
y = 'Contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
slopes = 1/(data_ind$N*(data_ind$Dh*1000*1000)**4)
test_plot <- expr(
ggplot(data_kh) +
geom_line(aes(x = d*1000*1000, y = Kp_uni2,color = Dh*1000*1000)) +
# scale_x_log10() +
scale_y_log10() +
labs(x = 'Xylem vessel diameter (µm)',
y = 'Contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
head(data_kh)
slopes = 1/(data_ind$N*(data_ind$Dh*1000*1000)**4)
test_plot <- expr(
ggplot(data_kh) +
geom_line(aes(x = d*1000*1000, y = Kp_uni2,color = Dh*1000*1000,group = ind)) +
# scale_x_log10() +
scale_y_log10() +
labs(x = 'Xylem vessel diameter (µm)',
y = 'Contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
head(data_kh)
inds <- unique(data_kh$ind)
data_kh2 <- data.frame()
for (indiv in inds){
temp <- data_kh %>% filter(ind == indiv) %>% select(ind,d,Kp_uni2,Dh)
data_kh2 <- rbind(data_kh2,
rbind(data.frame(ind = indiv,
d = temp$d[1],
Kp_uni2=0,
Dh = temp$Dh[1]),
temp))
}
data_kh2
head(data_kh2)
temp
data_kh2 <- data.frame()
data_kh2
rbind(data.frame(ind = indiv,
d = temp$d[1],
Kp_uni2=0,
Dh = temp$Dh[1]),
temp)
head(temp)
temp <- data_kh %>% filter(ind == indiv) %>% ungroup() %>% select(ind,d,Kp_uni2,Dh)
head(temp)
rbind(data.frame(ind = indiv,
d = temp$d[1],
Kp_uni2=0,
Dh = temp$Dh[1]),
temp)
inds <- unique(data_kh$ind)
data_kh2 <- data.frame()
for (indiv in inds){
temp <- data_kh %>% filter(ind == indiv) %>% ungroup() %>% select(ind,d,Kp_uni2,Dh)
data_kh2 <- rbind(data_kh2,
rbind(data.frame(ind = indiv,
d = temp$d[1],
Kp_uni2=0,
Dh = temp$Dh[1]),
temp))
}
test_plot <- expr(
ggplot(data_kh2) +
geom_line(aes(x = d*1000*1000, y = Kp_uni2,color = Dh*1000*1000,group = ind)) +
# scale_x_log10() +
scale_y_log10() +
labs(x = 'Xylem vessel diameter (µm)',
y = 'Contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
test_plot <- expr(
ggplot(data_kh) +
geom_line(aes(x = d*1000*1000, y = Kp_uni2,color = Dh*1000*1000,group = ind)) +
# scale_x_log10() +
scale_y_log10() +
labs(x = 'Xylem vessel diameter (µm)',
y = 'Contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
test_plot <- expr(
ggplot(data_kh) +
geom_line(aes(x = d*1000*1000, y = Kp_uni2,color = Dh*1000*1000,group = ind)) +
# scale_x_log10() +
scale_y_log10() +
labs(x = 'Xylem vessel diameter (µm)',
y = 'Cumulative contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
test_plot <- expr(
ggplot(data_kh) +
geom_line(aes(x = d*1000*1000, y = Kp_uni2,color = Dh*1000*1000,group = ind)) +
# scale_x_log10() +
# scale_y_log10() +
labs(x = 'Xylem vessel diameter (µm)',
y = 'Cumulative contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
test_plot <- expr(
ggplot(data_kh) +
geom_line(aes(x = d*1000*1000, y = Kp_uni2,color = Dh*1000*1000,group = ind)) +
scale_x_log10() +
# scale_y_log10() +
labs(x = 'Xylem vessel diameter (µm)',
y = 'Cumulative contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
test_plot <- expr(
ggplot(data_kh) +
geom_line(aes(x = d*1000*1000, y = Kp_uni2,color = Dh*1000*1000,group = ind)) +
# scale_x_log10() +
# scale_y_log10() +
labs(x = 'Xylem vessel diameter (µm)',
y = 'Cumulative contribution to Kp (%)') +
scale_color_gradient2(name = "Dh (µm)",
low = rgb(241, 54, 23, maxColorValue=255),
high = rgb(0, 61, 104, maxColorValue=255),
mid =  "grey90",
midpoint = 150) +
theme(axis.title.x = element_text(hjust = 0.5),
axis.title.y = element_text(hjust = 0.5, vjust = 1)))
# for (i in seq(nrow(data_ind))){
#   new_layer <- expr(stat_function(fun=function(x) x**4/(data_ind$N[!!i]*(data_ind$Dh[!!i]*1000*1000)**4)*100))
#   test_plot <- expr(!!test_plot + !!new_layer)
# }
eval(test_plot)
ggsave(filename = '~/Documents/Figures/distributions2.png',
plot = last_plot(),
width = 12, height = 10, units = "in", dpi=300)
ggsave(filename = '~/Documents/Figures/distributions2.png',
plot = last_plot(),
width = 8, height = 6, units = "in", dpi=300)
# SLope = 1/N/Dh**4 = 1/VD/WA/Dh**4
ggsave(filename = '~/Documents/Figures/distributions2.png',
plot = last_plot(),
width = 9, height = 6, units = "in", dpi=300)
# SLope = 1/N/Dh**4 = 1/VD/WA/Dh**4
rm(list=ls())
library(ggplot2)
library(ggridges)
library(viridis)
library(RColorBrewer)
library(dplyr)
library(gridExtra)
library(cowplot)
library(gtable)
library(e1071)
# Constants
constants <- list(rho = 1000, eta = 1.002e-9)
# Files
file0 <- '/home/femeunier/Documents/data/robin/data_Kp.csv'
data_kh <- as.data.frame(read.table(file0,sep=',',header = TRUE))
individuals <- sort(unique(data_kh$Liana.ID))
file1 <- '/home/femeunier/Documents/data/robin/family.csv'
samples <- as.data.frame(read.table(file1,sep=',',header = TRUE,stringsAsFactors = FALSE)) %>% arrange(ind) %>%
select(c('ind','dbh','stem','family','family','genus','wd')) %>% mutate (famgen = ifelse(genus == "",family,paste(family,genus))) %>%
mutate(family = sub("\\ .*", "", family)) %>% filter(family != '') %>% rename(Family = family) %>% filter(ind %in% individuals)
stem <- samples %>% select(c('ind','stem'))
file2 <- '/home/femeunier/Documents/data/robin/VD.csv'
VD <- as.data.frame(read.table(file2,sep=',',header = TRUE)) %>% rename(ind = Liana.ID) %>% arrange(ind) %>%
select(c('ind','Vessel.density..n.mm..','Kp..kg...m...Mpa.s.')) %>% rename(VD = 'Vessel.density..n.mm..')
data_kh$d <- data_kh$Diameter.if.circular..mm./1000
data_kh <- data_kh %>% rename(ind = Liana.ID) %>% merge(samples) %>% merge(VD)
data_kh <- data_kh %>% group_by(famgen) %>% mutate(Dh = (1/max(Vessel.number)*sum(d**4))**(1/4))
data_kh %>% filter(D..m. < 50/1000/1000) %>% add_count() %>% summarise(n_small = mean(n))
#######################################################################
skewness <- data_kh %>% ungroup() %>% group_by(ind) %>% summarise(skew = skewness( D..m. *1000*1000))
Ntot <- data_kh %>% ungroup() %>% filter(D..m.*1000*1000 >0) %>% group_by(ind) %>% add_count() %>% summarise( n = mean(n),
maxD = max(D..m.*1000*1000)) %>% filter(maxD >= 200)
Nlarge <- data_kh %>% ungroup() %>% filter(D..m.*1000*1000 >200) %>% group_by(ind) %>% add_count() %>% summarise( n = mean(n))
########################################################################
# Table Samples
ind_kh <- data_kh %>% group_by(ind,famgen) %>% add_count() %>% summarize(
dbh = mean(dbh,na.rm = TRUE),
wd = mean(wd,na.rm = TRUE),
N = mean(n),
d_median = median(d*1000*1000,na.rm = TRUE),
d_mean = (mean(d*1000*1000,na.rm = TRUE)),
d_sd = sd(d*1000*1000,na.rm = TRUE),
d_min = min(d*1000*1000,na.rm = TRUE),
d_max = max(d*1000*1000,na.rm = TRUE),
Dh = (mean(Dh*1000*1000, na.rm = TRUE)),
Area_tot = sum(Area..mm..),
VD = (mean(VD,na.rm=TRUE))) %>% mutate (Kp = (pi*constants$rho/(128*constants$eta)*(VD*1000*1000)*(Dh/1000/1000)**4)) %>%
mutate(VA = Area_tot/N*VD) %>% merge(stem) %>% arrange(famgen)    %>% mutate(d_mean = log10(d_mean),
VD = log10(VD),
Kp = log10(Kp),
Dh = log10(Dh))
PCA <- ind_kh %>% select(dbh,wd,d_mean,Dh,VD,Kp,VA,d_max) %>% rename(DBH = dbh,WD = wd,D = d_mean)
##########################################################
# PCA
library("FactoMineR")
library("factoextra")
rownames(PCA) <- ind_kh$famgen
res.pca <- PCA(PCA, graph = TRUE)
fviz_eig(res.pca, addlabels = TRUE, ylim = c(0, 50))
var <- get_pca_var(res.pca)
var$coord
fviz_pca_var(res.pca)
fviz_pca_var(res.pca, col.var = "cos2",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE # Évite le chevauchement de texte
)
fviz_pca_ind (res.pca, pointsize = "cos2",
pointshape = 21, fill = "#E7B800",
repel = TRUE # Évite le chevauchement de texte
)
fviz_pca_biplot(res.pca, repel = TRUE,
col.var = "#2E9FDF", # Couleur des variables
col.ind = "#696969",  # Couleur des individues
col.circle = "grey70"
)
rm(list=ls())
library(ggplot2)
library(ggridges)
library(viridis)
library(RColorBrewer)
library(dplyr)
library(gridExtra)
library(cowplot)
library(gtable)
library(e1071)
# Constants
constants <- list(rho = 1000, eta = 1.002e-9)
# Files
file0 <- '/home/femeunier/Documents/data/robin/data_Kp.csv'
data_kh <- as.data.frame(read.table(file0,sep=',',header = TRUE))
individuals <- sort(unique(data_kh$Liana.ID))
file1 <- '/home/femeunier/Documents/data/robin/family.csv'
samples <- as.data.frame(read.table(file1,sep=',',header = TRUE,stringsAsFactors = FALSE)) %>% arrange(ind) %>%
select(c('ind','dbh','stem','family','family','genus','wd')) %>% mutate (famgen = ifelse(genus == "",family,paste(family,genus))) %>%
mutate(family = sub("\\ .*", "", family)) %>% filter(family != '') %>% rename(Family = family) %>% filter(ind %in% individuals)
stem <- samples %>% select(c('ind','stem'))
file2 <- '/home/femeunier/Documents/data/robin/VD.csv'
VD <- as.data.frame(read.table(file2,sep=',',header = TRUE)) %>% rename(ind = Liana.ID) %>% arrange(ind) %>%
select(c('ind','Vessel.density..n.mm..','Kp..kg...m...Mpa.s.')) %>% rename(VD = 'Vessel.density..n.mm..')
data_kh$d <- data_kh$Diameter.if.circular..mm./1000
data_kh <- data_kh %>% rename(ind = Liana.ID) %>% merge(samples) %>% merge(VD)
data_kh <- data_kh %>% group_by(famgen) %>% mutate(Dh = (1/max(Vessel.number)*sum(d**4))**(1/4))
data_kh %>% filter(D..m. < 50/1000/1000) %>% add_count() %>% summarise(n_small = mean(n))
#######################################################################
skewness <- data_kh %>% ungroup() %>% group_by(ind) %>% summarise(skew = skewness( D..m. *1000*1000))
Ntot <- data_kh %>% ungroup() %>% filter(D..m.*1000*1000 >0) %>% group_by(ind) %>% add_count() %>% summarise( n = mean(n),
maxD = max(D..m.*1000*1000)) %>% filter(maxD >= 200)
Nlarge <- data_kh %>% ungroup() %>% filter(D..m.*1000*1000 >200) %>% group_by(ind) %>% add_count() %>% summarise( n = mean(n))
########################################################################
# Table Samples
ind_kh <- data_kh %>% group_by(ind,famgen) %>% add_count() %>% summarize(
dbh = mean(dbh,na.rm = TRUE),
wd = mean(wd,na.rm = TRUE),
N = mean(n),
d_median = median(d*1000*1000,na.rm = TRUE),
d_mean = (mean(d*1000*1000,na.rm = TRUE)),
d_sd = sd(d*1000*1000,na.rm = TRUE),
d_min = min(d*1000*1000,na.rm = TRUE),
d_max = max(d*1000*1000,na.rm = TRUE),
Dh = (mean(Dh*1000*1000, na.rm = TRUE)),
Area_tot = sum(Area..mm..),
VD = (mean(VD,na.rm=TRUE))) %>% mutate (Kp = (pi*constants$rho/(128*constants$eta)*(VD*1000*1000)*(Dh/1000/1000)**4)) %>%
mutate(VA = Area_tot/N*VD) %>% merge(stem) %>% arrange(famgen)    %>% mutate(d_mean = log10(d_mean),
VD = log10(VD),
Kp = log10(Kp),
Dh = log10(Dh))
PCA <- ind_kh %>% select(dbh,wd,d_mean,Dh,VD,Kp,VA,d_max) %>% rename(DBH = dbh,WD = wd,D = d_mean)
##########################################################
# PCA
library("FactoMineR")
library("factoextra")
rownames(PCA) <- ind_kh$famgen
res.pca <- PCA(PCA, graph = TRUE)
fviz_eig(res.pca, addlabels = TRUE, ylim = c(0, 50))
var <- get_pca_var(res.pca)
var$coord
fviz_pca_var(res.pca)
fviz_pca_var(res.pca, col.var = "cos2",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE # Évite le chevauchement de texte
)
fviz_pca_ind (res.pca, pointsize = "cos2",
pointshape = 21, fill = "#E7B800",
repel = TRUE # Évite le chevauchement de texte
)
fviz_pca_biplot(res.pca, repel = TRUE,
col.var = "#2E9FDF", # Couleur des variables
col.ind = "#696969",  # Couleur des individues
col.circle = "grey70"
)
ggsave(plot=last_plot(),
dpi = 300,width = 30,height = 25,units = 'cm',
filename = '~/Documents/Figures/PCA.png')
ind_kh2 <- data_kh %>% group_by(ind,famgen) %>% add_count() %>% summarize(
dbh = mean(dbh,na.rm = TRUE),
wd = mean(wd,na.rm = TRUE),
N = mean(n),
d_median = median(d*1000*1000,na.rm = TRUE),
d_mean = mean(d*1000*1000,na.rm = TRUE),
d_sd = sd(d*1000*1000,na.rm = TRUE),
d_min = min(d*1000*1000,na.rm = TRUE),
d_max = max(d*1000*1000,na.rm = TRUE),
Dh = mean(Dh*1000*1000, na.rm = TRUE),
Area_tot = sum(Area..mm..),
VD = mean(VD,na.rm=TRUE)) %>% mutate (Kp = pi*constants$rho/(128*constants$eta)*(VD*1000*1000)*(Dh/1000/1000)**4) %>%
mutate(VA = Area_tot/N*VD) %>% merge(stem)
contri50 <- c(271.750,174.808,123.608,244.627,392.507,494.431,214.095,292.074,355.036,133.512,155.536,296.401,192.156,394.126,276.395,296.401,244.627,
392.507,379.310,292.074,249.777,344.109)
Table1 <- ind_kh %>% select(-c('ind','Area_tot')) %>%
mutate(dbh = round(dbh,digits = 1),
wd = round(wd,digits = 2),
D = paste0(round(d_median,digits = 0),' [',round(d_min,digits = 0),'-',round(d_max,digits = 0),']'),
Dmedian = paste0(round(d_mean,digits = 0), ' ± ', round(d_sd,digits = 0)),
Dh = round(Dh,digits = 0),
VD = round(VD,digits = 1),
VA = round(VA*100, digits = 1),
Kp = round(Kp, digits = 2)
# stem = case_when(
#   stem == 'AC' ~ '',
#   stem == 'BER' ~ '',
#   stem == 'BS' ~ '',
#   stem == 'BE' ~ '',
#   stem == 'FP' ~ '',
# )
) %>% select(c('famgen','dbh','wd','N','D','Dmedian','Dh','VD','VA','Kp'))
write.table(Table1,file = '~/Documents/papers/robin/Tables/Table1.csv',sep = ',',row.names = FALSE)
# Table family
family <- samples %>% merge(unique(ind_kh),by = 'ind') %>% group_by(Family) %>% add_count() %>% summarize(
N = mean(n),
mean_dbh = mean(dbh.x, na.rm = TRUE),
std_dbh = sd(dbh.x, na.rm = TRUE),
mean_wd = mean(wd.y, na.rm = TRUE),
std_wd = sd(wd.y, na.rm = TRUE),
mean_d = mean(d_mean, na.rm = TRUE),
std_d = sd(d_mean, na.rm = TRUE),
mean_Dh = mean(Dh, na.rm = TRUE),
std_Dh = sd(Dh, na.rm = TRUE),
mean_Kp = mean(Kp, na.rm = TRUE),
std_Kp = sd(Kp, na.rm = TRUE),
mean_VD = mean(VD, na.rm = TRUE),
std_VD = sd(VD, na.rm = TRUE),
mean_VA = mean(VA*100, na.rm = TRUE),
std_VA = sd(VA*100, na.rm = TRUE) )
Table2 <- family %>% mutate(
DBH = ifelse(N>1,paste(round(mean_dbh,digits = 1),round(std_dbh,digits = 1),sep = ' ± '),round(mean_dbh,digits = 1)),
WD = ifelse(N>1,paste(round(mean_wd,digits = 2),round(std_wd,digits = 2),sep = ' ± '),round(mean_wd,digits = 2)),
D = ifelse(N>1,paste(round(mean_d,digits = 0),round(std_d,digits = 0),sep = ' ± ')   ,round(mean_d,digits = 0)),
Dh = ifelse(N>1,paste(round(mean_Dh,digits = 0),round(std_Dh,digits = 0),sep = ' ± '),round(mean_Dh,digits = 0)),
VD = ifelse(N>1,paste(round(mean_VD,digits = 1),round(std_VD,digits = 1),sep = ' ± '),round(mean_VD,digits = 1)),
VA = ifelse(N>1,paste(round(mean_VA,digits = 1),round(std_VA,digits = 1),sep = ' ± '),round(mean_VA,digits = 1)),
Kp = ifelse(N>1,paste(round(mean_Kp,digits = 2),round(std_Kp,digits = 2),sep = ' ± '),round(mean_Kp,digits = 2))) %>%
select(c('Family','N','DBH','WD','D','Dh','VD','VA','Kp'))
write.table(Table2,file = '~/Documents/papers/robin/Tables/Table2.csv',sep = ',',row.names = FALSE)
# All together
# To do
all <- data.frame(median = c(median(ind_kh$dbh),median(ind_kh$wd),median(data_kh$d)*1000*1000,median(ind_kh$Dh),median(ind_kh$VD),median(ind_kh$VA*100),median(ind_kh$Kp)),
mean = c(mean(ind_kh$dbh),mean(ind_kh$wd),mean(data_kh$d)*1000*1000,mean(ind_kh$Dh),mean(ind_kh$VD),mean(ind_kh$VA*100),mean(ind_kh$Kp)),
min = c(min(ind_kh$dbh),min(ind_kh$wd),min(data_kh$d)*1000*1000,min(ind_kh$Dh),min(ind_kh$VD),min(ind_kh$VA*100),min(ind_kh$Kp)),
max = c(max(ind_kh$dbh),max(ind_kh$wd),max(data_kh$d)*1000*1000,max(ind_kh$Dh),max(ind_kh$VD),max(ind_kh$VA*100),max(ind_kh$Kp)),
std = c(sd(ind_kh$dbh),sd(ind_kh$wd),sd(data_kh$d)*1000*1000,sd(ind_kh$Dh),sd(ind_kh$VD),sd(ind_kh$VA*100),sd(ind_kh$Kp)))
rownames(all) <- c('DBH','WD','D','Dh','VD','VA','Kp')
all[1,] <- round(all[1,],digits = 1)
all[2,] <- round(all[2,],digits = 2)
all[3,] <- round(all[3,],digits = 0)
all[4,] <- round(all[4,],digits = 0)
all[5,] <- round(all[5,],digits = 1)
all[6,] <- round(all[6,],digits = 1)
all[7,] <- round(all[7,],digits = 2)
Table3 <- all
write.table(Table3,file = '~/Documents/papers/robin/Tables/Table3.csv',sep = ',',row.names = TRUE)
select_ind <- ind_kh %>% select(-one_of(c('famgen','stem'))) %>%
select(c('dbh','d_mean','Dh','VD','Kp','VA','wd','d_max')) %>% rename(D = d_mean,DBH = dbh)
colsc=c(rgb(241, 54, 23, maxColorValue=255), 'white', rgb(0, 61, 104, maxColorValue=255))
colramp = colorRampPalette(colsc, space='Lab')
colors = colramp(100)
source('~/Documents/R/Robin/my.plotcorr.r')
my.plotcorr(cor(select_ind), col=colors[((cor(select_ind) + 1)/2) * 100],
diag='hist',
lower.panel="number",
main='Predictor correlations')
source('~/Documents/R/Robin/R/figure_comp.r', echo=TRUE)
setwd("~/Documents/R/Robin")
source('~/Documents/R/Robin/R/figure_comp.r', echo=TRUE)
source('~/Documents/R/Robin/R/figure_comp.r', echo=TRUE)
source('~/Documents/R/Robin/R/Tables_and_corrplot.r', echo=TRUE)
source('~/Documents/R/Robin/R/figure_comp.r', echo=TRUE)
source('~/Documents/R/Robin/R/figure_contribution_Kp.r', echo=TRUE)
source('~/Documents/R/Robin/R/figure_d_distribution.r', echo=TRUE)
source('~/Documents/R/Robin/R/figure_rossell.r', echo=TRUE)
source('~/Documents/R/Robin/R/PCA.r', echo=TRUE)
source('~/Documents/R/Robin/R/Tables_and_corrplot.r', echo=TRUE)
